<%= form_with model: [form_object, page_object], url: action_path do |f| %>
  <%= f.hidden_field :answer_type if is_new_page %>

  <%= f.govuk_error_summary %>

  <%= f.govuk_text_field :question_text, label: { size: 'm' } %>

  <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible" />

  <%= f.govuk_text_field :hint_text, label: { size: 'm' } %>

  <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible" />

  <% if page_object.answer_type == 'selection' %>
    <%= f.hidden_field :is_optional %>
  <% else %>
    <%= f.govuk_check_boxes_fieldset :is_optional, multiple: false, legend: { text: t("pages.add_rules_legend") , size: 'm' } do %>
      <%= f.govuk_check_box :is_optional, true,0, multiple: false,
                            small: true,
                            label: { text: t("pages.make_optional_text")  },
                            hint: { text: t("pages.make_optional_hint") } %>

    <% end %>
  <% end %>

  <%# TODO: move to component? %>
  <%= govuk_summary_list do |summary_list| %>
    <%= summary_list.row do |row|
      row.key(text: "Answer type")
      row.value(text: t("helpers.label.page.answer_type_options.names.#{page_object.answer_type}"))
      row.action(text: "Change",
                 href: change_answer_type_path,
                 visually_hidden_text: "Answer type " + t("helpers.label.page.answer_type_options.names.#{page_object.answer_type}")
      ) end %>

      <% if (page_object.answer_type == "selection") %>
        <%= summary_list.row do |row|
          row.key(text: "Options")
          row.value(text: page_object.show_selection_options)
          row.action(text: "Change",
                    href: change_selections_settings_path,
                    visually_hidden_text: "Options") end %>
        <%= summary_list.row do |row|
          row.key(text: t("selections_settings.only_one_option"))
          row.value(text: page_object.answer_settings.only_one_option == "true" ? t("selections_settings.yes") : t("selections_settings.no"))
          row.action(text: "Change",
                    href: change_selections_settings_path,
                    visually_hidden_text: t("selections_settings.only_one_option")) end %>
        <%= summary_list.row do |row|
          row.key(text: t("selections_settings.include_none_of_the_above"))
          row.value(text: page_object.is_optional? ? t("selections_settings.yes") : t("selections_settings.no"))
          row.action(text: "Change",
                    href: change_selections_settings_path,
                    visually_hidden_text: t("selections_settings.include_none_of_the_above")) end %>
    <% end %>
  <% end %>

  <%= f.govuk_submit page_object.has_next_page? ? t("pages.submit_edit") : t("pages.submit_add") do %>
    <%= f.govuk_submit t('pages.submit_save'), name: :save_preview, secondary: true %>
  <% end %>

  <%= f.govuk_submit t('pages.delete_question'), name: :delete, warning: true unless is_new_page %>
<% end %>
